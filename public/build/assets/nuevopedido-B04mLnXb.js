jQuery=window.$;$(document).ready(function(){var f=window.productosDisponibles||[];f.length===0&&console.warn("La lista de productos está vacía. Asegúrate de que 'window.productosDisponibles' tenga datos.");var m=document.getElementById("productos-container"),x=document.getElementById("total"),b=document.getElementById("agregar-producto"),v=0;b&&b.addEventListener("click",function(){I()});function I(){var y;let e=document.createElement("div");e.classList.add("producto","row","mb-3");let n=document.createElement("div");n.classList.add("col-md-4");let l=document.createElement("label");l.innerText="Producto";let t=document.createElement("select");t.name="producto[]",t.classList.add("form-control"),t.required=!0,f.forEach(function(E){let p=document.createElement("option");p.value=E.id,p.setAttribute("data-precio",E.precio),p.innerText=E.nombre,t.appendChild(p)}),n.appendChild(l),n.appendChild(t),e.appendChild(n);let r=document.createElement("div");r.classList.add("col-md-2");let g=document.createElement("label");g.innerText="Cantidad";let d=document.createElement("input");d.type="number",d.name="cantidad[]",d.classList.add("form-control"),d.value=1,d.min=1,r.appendChild(g),r.appendChild(d),e.appendChild(r);let u=document.createElement("div");u.classList.add("col-md-3");let L=document.createElement("label");L.innerText="Costo";let a=document.createElement("input");a.type="number",a.step="0.01",a.name="precio[]",a.classList.add("form-control"),a.value=((y=t.options[t.selectedIndex])==null?void 0:y.getAttribute("data-precio"))||0,a.min=0,u.appendChild(L),u.appendChild(a),e.appendChild(u);let s=document.createElement("div");s.classList.add("col-md-2");let C=document.createElement("label");C.innerText="Descuento";let o=document.createElement("input");o.type="number",o.name="descuento[]",o.classList.add("form-control"),o.value=0,o.min=0,s.appendChild(C),s.appendChild(o),e.appendChild(s);let h=document.createElement("div");h.classList.add("col-md-1","d-flex","align-items-end");let c=document.createElement("button");c.type="button",c.classList.add("btn","btn-danger"),c.innerHTML="<i class='fas fa-trash-alt'></i>",h.appendChild(c),e.appendChild(h),m.appendChild(e),t.addEventListener("change",function(){D(t,a)}),d.addEventListener("input",i),a.addEventListener("input",i),o.addEventListener("input",i),c.addEventListener("click",function(){m.removeChild(e),i()}),i()}function D(e,n){var t;let l=((t=e.options[e.selectedIndex])==null?void 0:t.getAttribute("data-precio"))||0;n.value=parseFloat(l).toFixed(2),i()}function i(){v=0,m.querySelectorAll(".producto").forEach(function(e){let n=parseInt(e.querySelector('input[name="cantidad[]"]').value)||0,l=parseFloat(e.querySelector('input[name="precio[]"]').value)||0,t=parseFloat(e.querySelector('input[name="descuento[]"]').value)||0;v+=n*l-t}),x.value=v.toFixed(2)}$(document).ready(function(){$(".editPagoBtn").click(function(){let e=$(this).data("id"),n=route("pagos.update",e);console.log(n),$("#editPagoForm").attr("action",n),$("#editFecha").val($(this).data("fecha")),$("#editMetodo").val($(this).data("metodo")),$("#editBanco").val($(this).data("banco")),$("#editMonto").val($(this).data("monto"))}),$(".deletePagoBtn").click(function(e){e.preventDefault(),confirm("¿Estás seguro de eliminar este pago? Esta acción no se puede deshacer.")&&$(this).closest("form").submit()})})});
