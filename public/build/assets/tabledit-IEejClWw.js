/*!
 * Tabledit v1.2.3 (https://github.com/markcell/jQuery-Tabledit)
 * Copyright (c) 2015 Celso Marques
 * Licensed under MIT (https://github.com/markcell/jQuery-Tabledit/blob/master/LICENSE)
 */if(typeof jQuery>"u")throw new Error("Tabledit requires jQuery library.");(function(e){e.fn.Tabledit=function(f){if(!this.is("table"))throw new Error("Tabledit only works when applied to a table.");var s=this,w={url:window.location.href,inputClass:"form-control input-sm",toolbarClass:"btn-toolbar",groupClass:"btn-group btn-group-sm",dangerClass:"danger",warningClass:"warning",mutedClass:"text-muted",eventType:"click",rowIdentifier:"id",hideIdentifier:!1,autoFocus:!0,editButton:!0,deleteButton:!0,saveButton:!0,restoreButton:!0,buttons:{edit:{class:"btn btn-sm btn-default",html:'<span class="glyphicon glyphicon-pencil"></span>',action:"edit"},delete:{class:"btn btn-sm btn-default",html:'<span class="glyphicon glyphicon-trash"></span>',action:"delete"},save:{class:"btn btn-sm btn-success",html:"Save"},restore:{class:"btn btn-sm btn-warning",html:"Restore",action:"restore"},confirm:{class:"btn btn-sm btn-danger",html:"Confirm"}},onDraw:function(){},onSuccess:function(){},onFail:function(){},onAlways:function(){},onAjax:function(){}},n=e.extend(!0,w,f),h="undefined",p="undefined",m={columns:{identifier:function(){n.hideIdentifier&&s.find("th:nth-child("+parseInt(n.columns.identifier[0])+1+"), tbody td:nth-child("+parseInt(n.columns.identifier[0])+1+")").hide();var t=s.find("tbody td:nth-child("+(parseInt(n.columns.identifier[0])+1)+")");t.each(function(){var i='<span class="tabledit-span tabledit-identifier">'+e(this).text()+"</span>",a='<input class="tabledit-input tabledit-identifier" type="hidden" name="'+n.columns.identifier[1]+'" value="'+e(this).text()+'" disabled>';e(this).html(i+a),e(this).parent("tr").attr(n.rowIdentifier,e(this).text())})},editable:function(){for(var t=0;t<n.columns.editable.length;t++){var i=s.find("tbody td:nth-child("+(parseInt(n.columns.editable[t][0])+1)+")");i.each(function(){var a=e(this).text();n.editButton||e(this).css("cursor","pointer");var l='<span class="tabledit-span">'+a+"</span>";if(typeof n.columns.editable[t][2]<"u"){var d='<select class="tabledit-input '+n.inputClass+'" name="'+n.columns.editable[t][1]+'" style="display: none;" disabled>';e.each(jQuery.parseJSON(n.columns.editable[t][2]),function(r,b){a===b?d+='<option value="'+r+'" selected>'+b+"</option>":d+='<option value="'+r+'">'+b+"</option>"}),d+="</select>"}else var d='<input class="tabledit-input '+n.inputClass+'" type="text" name="'+n.columns.editable[t][1]+'" value="'+e(this).text()+'" style="display: none;" disabled>';e(this).html(l+d),e(this).addClass("tabledit-view-mode")})}},toolbar:function(){if(n.editButton||n.deleteButton){var t="",i="",a="",l="",d="";s.find("th.tabledit-toolbar-column").length===0&&s.find("tr:first").append('<th class="tabledit-toolbar-column"></th>'),n.editButton&&(t='<button type="button" class="tabledit-edit-button '+n.buttons.edit.class+'" style="float: none;">'+n.buttons.edit.html+"</button>"),n.deleteButton&&(i='<button type="button" class="tabledit-delete-button '+n.buttons.delete.class+'" style="float: none;">'+n.buttons.delete.html+"</button>",d='<button type="button" class="tabledit-confirm-button '+n.buttons.confirm.class+'" style="display: none; float: none;">'+n.buttons.confirm.html+"</button>"),n.editButton&&n.saveButton&&(a='<button type="button" class="tabledit-save-button '+n.buttons.save.class+'" style="display: none; float: none;">'+n.buttons.save.html+"</button>"),n.deleteButton&&n.restoreButton&&(l='<button type="button" class="tabledit-restore-button '+n.buttons.restore.class+'" style="display: none; float: none;">'+n.buttons.restore.html+"</button>");var r='<div class="tabledit-toolbar '+n.toolbarClass+`" style="text-align: left;">
                                           <div class="`+n.groupClass+'" style="float: none;">'+t+i+`</div>
                                           `+a+`
                                           `+d+`
                                           `+l+`
                                       </div></div>`;s.find("tbody>tr").append('<td style="white-space: nowrap; width: 1%;">'+r+"</td>")}}}},c={view:function(t){var i=e(t).parent("tr");e(t).parent("tr").find(".tabledit-input.tabledit-identifier").prop("disabled",!0),e(t).find(".tabledit-input").blur().hide().prop("disabled",!0),e(t).find(".tabledit-span").show(),e(t).addClass("tabledit-view-mode").removeClass("tabledit-edit-mode"),n.editButton&&(i.find("button.tabledit-save-button").hide(),i.find("button.tabledit-edit-button").removeClass("active").blur())},edit:function(t){u.reset(t);var i=e(t).parent("tr");i.find(".tabledit-input.tabledit-identifier").prop("disabled",!1),e(t).find(".tabledit-span").hide();var a=e(t).find(".tabledit-input");a.prop("disabled",!1).show(),n.autoFocus&&a.focus(),e(t).addClass("tabledit-edit-mode").removeClass("tabledit-view-mode"),n.editButton&&(i.find("button.tabledit-edit-button").addClass("active"),i.find("button.tabledit-save-button").show())}},o={reset:function(t){e(t).each(function(){var i=e(this).find(".tabledit-input"),a=e(this).find(".tabledit-span").text();i.is("select")?i.find("option").filter(function(){return e.trim(e(this).text())===a}).attr("selected",!0):i.val(a),c.view(this)})},submit:function(t){var i=v(n.buttons.edit.action);i!==!1&&(e(t).each(function(){var a=e(this).find(".tabledit-input");a.is("select")?e(this).find(".tabledit-span").text(a.find("option:selected").text()):e(this).find(".tabledit-span").text(a.val()),c.view(this)}),h=e(t).parent("tr"))}},u={reset:function(t){s.find(".tabledit-confirm-button").hide(),s.find(".tabledit-delete-button").removeClass("active").blur()},submit:function(t){u.reset(t),e(t).parent("tr").find("input.tabledit-identifier").attr("disabled",!1);var i=v(n.buttons.delete.action);e(t).parents("tr").find("input.tabledit-identifier").attr("disabled",!0),i!==!1&&(e(t).parent("tr").addClass("tabledit-deleted-row"),e(t).parent("tr").addClass(n.mutedClass).find(".tabledit-toolbar button:not(.tabledit-restore-button)").attr("disabled",!0),e(t).find(".tabledit-restore-button").show(),p=e(t).parent("tr"))},confirm:function(t){s.find("td.tabledit-edit-mode").each(function(){o.reset(this)}),e(t).find(".tabledit-delete-button").addClass("active"),e(t).find(".tabledit-confirm-button").show()},restore:function(t){e(t).parent("tr").find("input.tabledit-identifier").attr("disabled",!1);var i=v(n.buttons.restore.action);e(t).parents("tr").find("input.tabledit-identifier").attr("disabled",!0),i!==!1&&(e(t).parent("tr").removeClass("tabledit-deleted-row"),e(t).parent("tr").removeClass(n.mutedClass).find(".tabledit-toolbar button").attr("disabled",!1),e(t).find(".tabledit-restore-button").hide(),e(t).parent("tr"))}};function v(t){var i=s.find(".tabledit-input").serialize()+"&action="+t,a=n.onAjax(t,i);if(a===!1)return!1;var l=e.post(n.url,i,function(d,r,b){t===n.buttons.edit.action&&(h.removeClass(n.dangerClass).addClass(n.warningClass),setTimeout(function(){s.find("tr."+n.warningClass).removeClass(n.warningClass)},1400)),n.onSuccess(d,r,b)},"json");return l.fail(function(d,r,b){t===n.buttons.delete.action?(p.removeClass(n.mutedClass).addClass(n.dangerClass),p.find(".tabledit-toolbar button").attr("disabled",!1),p.find(".tabledit-toolbar .tabledit-restore-button").hide()):t===n.buttons.edit.action&&h.addClass(n.dangerClass),n.onFail(d,r,b)}),l.always(function(){n.onAlways()}),l}return m.columns.identifier(),m.columns.editable(),m.columns.toolbar(),n.onDraw(),n.deleteButton&&(s.on("click","button.tabledit-delete-button",function(t){if(t.handled!==!0){t.preventDefault();var i=e(this).hasClass("active"),a=e(this).parents("td");u.reset(a),i||u.confirm(a),t.handled=!0}}),s.on("click","button.tabledit-confirm-button",function(t){if(t.handled!==!0){t.preventDefault();var i=e(this).parents("td");u.submit(i),t.handled=!0}})),n.restoreButton&&s.on("click","button.tabledit-restore-button",function(t){t.handled!==!0&&(t.preventDefault(),u.restore(e(this).parents("td")),t.handled=!0)}),n.editButton?(s.on("click","button.tabledit-edit-button",function(t){if(t.handled!==!0){t.preventDefault();var i=e(this),a=i.hasClass("active");o.reset(s.find("td.tabledit-edit-mode")),a||e(i.parents("tr").find("td.tabledit-view-mode").get().reverse()).each(function(){c.edit(this)}),t.handled=!0}}),s.on("click","button.tabledit-save-button",function(t){t.handled!==!0&&(t.preventDefault(),o.submit(e(this).parents("tr").find("td.tabledit-edit-mode")),t.handled=!0)})):(s.on(n.eventType,"tr:not(.tabledit-deleted-row) td.tabledit-view-mode",function(t){t.handled!==!0&&(t.preventDefault(),o.reset(s.find("td.tabledit-edit-mode")),c.edit(this),t.handled=!0)}),s.on("change","select.tabledit-input:visible",function(){event.handled!==!0&&(o.submit(e(this).parent("td")),event.handled=!0)}),e(document).on("click",function(t){var i=s.find(".tabledit-edit-mode");!i.is(t.target)&&i.has(t.target).length===0&&o.reset(s.find(".tabledit-input:visible").parent("td"))})),e(document).on("keyup",function(t){var i=s.find(".tabledit-input:visible"),a=s.find(".tabledit-confirm-button");if(i.length>0)var l=i.parents("td");else if(a.length>0)var l=a.parents("td");else return;switch(t.keyCode){case 9:n.editButton||(o.submit(l),c.edit(l.closest("td").next()));break;case 13:o.submit(l);break;case 27:o.reset(l),u.reset(l);break}}),this}})(jQuery);(function(e){var f=function(){};f.prototype.init=function(){e("#inline-editable").Tabledit({inputClass:"form-control form-control-sm",editButton:!1,deleteButton:!1,columns:{identifier:[0,"id"],editable:[[1,"col1"],[2,"col2"],[3,"col3"],[4,"col4"],[6,"col6"]]}}),e("#btn-editable").Tabledit({buttons:{edit:{class:"btn btn-primary",html:'<i class="mdi mdi-pencil"></i>',action:"edit"}},inputClass:"form-control form-control-sm",deleteButton:!1,saveButton:!1,autoFocus:!1,columns:{identifier:[0,"id"],editable:[[1,"col1"],[2,"col2"],[3,"col3"],[4,"col4"],[6,"col6"]]}})},e.EditableTable=new f,e.EditableTable.Constructor=f})(window.jQuery),function(e){e.EditableTable.init()}(window.jQuery);
